# ğŸ” ShiftMaster - ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­è¨ˆæ›¸

## ğŸ“‹ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ¦‚è¦

ShiftMasteråŒ»ç™‚ã‚·ãƒ•ãƒˆç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã¯ã€åŒ»ç™‚æ©Ÿé–¢ç‰¹æœ‰ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¦ä»¶ã«å¯¾å¿œã—ãŸå¤šå±¤é˜²å¾¡ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’æ¡ç”¨ã—ã¦ã„ã¾ã™ã€‚

## ğŸ¥ åŒ»ç™‚ã‚·ã‚¹ãƒ†ãƒ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¦ä»¶

### æº–æ‹ æ³•è¦ãƒ»è¦æ ¼

| æ³•è¦ãƒ»è¦æ ¼ | æ¦‚è¦ | å¯¾å¿œçŠ¶æ³ |
|-----------|------|----------|
| **HIPAA** | Health Insurance Portability and Accountability Act | âœ… å®Œå…¨å¯¾å¿œ |
| **å€‹äººæƒ…å ±ä¿è­·æ³•** | æ—¥æœ¬ã®å€‹äººæƒ…å ±ä¿è­·ã«é–¢ã™ã‚‹æ³•å¾‹ | âœ… å®Œå…¨å¯¾å¿œ |
| **åŒ»ç™‚æƒ…å ±ã‚·ã‚¹ãƒ†ãƒ å®‰å…¨ç®¡ç†ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³** | åšç”ŸåŠ´åƒçœã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ï¼ˆç¬¬6.0ç‰ˆï¼‰ | âœ… å®Œå…¨å¯¾å¿œ |
| **ISO 27001** | æƒ…å ±ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆã‚·ã‚¹ãƒ†ãƒ  | âœ… æº–æ‹  |
| **ISO 27799** | åŒ»ç™‚æ©Ÿé–¢ã«ãŠã‘ã‚‹æƒ…å ±ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ | âœ… æº–æ‹  |

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£åˆ†é¡

```
ğŸ”’ æ¥µæ©Ÿå¯† (Top Secret)
â”œâ”€ æ‚£è€…å€‹äººè­˜åˆ¥æƒ…å ± (PII)
â”œâ”€ åŒ»ç™‚è¨ºæ–­æƒ…å ±
â””â”€ æ²»ç™‚å±¥æ­´ãƒ»æŠ•è–¬è¨˜éŒ²

ğŸ” æ©Ÿå¯† (Confidential) 
â”œâ”€ ã‚¹ã‚¿ãƒƒãƒ•å€‹äººæƒ…å ±
â”œâ”€ å‹¤å‹™æ™‚é–“ãƒ»çµ¦ä¸æƒ…å ±
â””â”€ åŒ»ç™‚æ©Ÿé–¢å†…éƒ¨æƒ…å ±

ğŸ›¡ï¸ åˆ¶é™ (Restricted)
â”œâ”€ ã‚·ãƒ•ãƒˆã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«
â”œâ”€ éƒ¨ç½²é…ç½®æƒ…å ±
â””â”€ ã‚·ã‚¹ãƒ†ãƒ è¨­å®šæƒ…å ±

ğŸ“‹ å†…éƒ¨ (Internal)
â”œâ”€ ä¸€èˆ¬çš„ãªæ¥­å‹™ãƒ‡ãƒ¼ã‚¿
â”œâ”€ å…¬é–‹å¯èƒ½ãªçµ±è¨ˆæƒ…å ±
â””â”€ ã‚·ã‚¹ãƒ†ãƒ ãƒ­ã‚°ï¼ˆéæ©Ÿå¯†éƒ¨åˆ†ï¼‰
```

## ğŸ›¡ï¸ å¤šå±¤é˜²å¾¡ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ¬ã‚¤ãƒ¤ãƒ¼

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸŒ ã‚¨ãƒƒã‚¸ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ WAF (Web Application Firewall)   â”‚
â”‚ â€¢ DDoS Protection                  â”‚
â”‚ â€¢ GeoBlocking                      â”‚
â”‚ â€¢ Rate Limiting                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ” èªè¨¼ãƒ»èªå¯ãƒ¬ã‚¤ãƒ¤ãƒ¼                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ Multi-Factor Authentication      â”‚
â”‚ â€¢ RBAC (Role-Based Access Control) â”‚
â”‚ â€¢ JWT Token Management             â”‚
â”‚ â€¢ Session Security                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸš€ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ Input Validation                 â”‚
â”‚ â€¢ Output Encoding                  â”‚
â”‚ â€¢ CSRF Protection                  â”‚
â”‚ â€¢ XSS Prevention                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ’¾ ãƒ‡ãƒ¼ã‚¿ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ Encryption at Rest               â”‚
â”‚ â€¢ Encryption in Transit            â”‚
â”‚ â€¢ Data Masking                     â”‚
â”‚ â€¢ Backup Encryption                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ” ç›£è¦–ãƒ»ç›£æŸ»ãƒ¬ã‚¤ãƒ¤ãƒ¼                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ Security Information and Event   â”‚
â”‚   Management (SIEM)               â”‚
â”‚ â€¢ Audit Logging                   â”‚
â”‚ â€¢ Intrusion Detection             â”‚
â”‚ â€¢ Vulnerability Scanning          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”‘ èªè¨¼ãƒ»èªå¯ã‚·ã‚¹ãƒ†ãƒ 

### å¤šè¦ç´ èªè¨¼ (MFA)

```python
# èªè¨¼è¦ç´ ã®çµ„ã¿åˆã‚ã›
AUTHENTICATION_FACTORS = {
    "something_you_know": [
        "password",
        "security_questions"
    ],
    "something_you_have": [
        "mobile_app_token",
        "sms_code",
        "email_code",
        "hardware_token"
    ],
    "something_you_are": [
        "fingerprint",  # å°†æ¥å®Ÿè£…
        "face_recognition"  # å°†æ¥å®Ÿè£…
    ]
}

# åŒ»ç™‚å¾“äº‹è€…åˆ¥èªè¨¼è¦ä»¶
ROLE_AUTH_REQUIREMENTS = {
    "doctor": {
        "factors_required": 2,
        "session_timeout": 30,  # åˆ†
        "password_complexity": "high"
    },
    "nurse": {
        "factors_required": 2,
        "session_timeout": 60,
        "password_complexity": "medium"
    },
    "admin": {
        "factors_required": 3,
        "session_timeout": 15,
        "password_complexity": "maximum"
    }
}
```

### ãƒ­ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ (RBAC)

```python
# ã‚¢ã‚¯ã‚»ã‚¹è¨±å¯ãƒãƒˆãƒªãƒƒã‚¯ã‚¹
PERMISSION_MATRIX = {
    "patient_data": {
        "doctor": ["read", "write", "update"],
        "nurse": ["read", "update"],
        "admin": ["read"],
        "scheduler": []  # ã‚¢ã‚¯ã‚»ã‚¹ä¸å¯
    },
    "shift_schedule": {
        "doctor": ["read", "write", "update", "delete"],
        "nurse": ["read", "update"],
        "admin": ["read", "write", "update", "delete"],
        "scheduler": ["read", "write", "update"]
    },
    "staff_management": {
        "doctor": ["read"],
        "nurse": ["read"],
        "admin": ["read", "write", "update", "delete"],
        "scheduler": ["read"]
    },
    "system_settings": {
        "doctor": [],
        "nurse": [],
        "admin": ["read", "write", "update"],
        "scheduler": []
    }
}

# å‹•çš„ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡
def check_access_permission(user, resource, action, context=None):
    """
    å‹•çš„ã‚¢ã‚¯ã‚»ã‚¹è¨±å¯ãƒã‚§ãƒƒã‚¯
    """
    # åŸºæœ¬ãƒ­ãƒ¼ãƒ«ç¢ºèª
    base_permission = has_role_permission(user.role, resource, action)
    if not base_permission:
        return False
    
    # ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆä¾å­˜ãƒã‚§ãƒƒã‚¯
    if context:
        # éƒ¨ç½²åˆ¶é™
        if resource == "shift_schedule" and context.get("department"):
            if not user.has_department_access(context["department"]):
                return False
        
        # æ™‚é–“åˆ¶é™
        if context.get("time_restricted"):
            if not is_within_allowed_hours(user):
                return False
        
        # ç·Šæ€¥æ™‚ä¾‹å¤–
        if context.get("emergency_override"):
            return has_emergency_access(user)
    
    return True
```

## ğŸ”’ ãƒ‡ãƒ¼ã‚¿æš—å·åŒ–

### æš—å·åŒ–æ–¹å¼

```python
# æš—å·åŒ–è¨­å®š
ENCRYPTION_CONFIG = {
    "algorithm": "AES-256-GCM",
    "key_derivation": "PBKDF2-SHA256",
    "iterations": 100000,
    "salt_length": 32,
    "tag_length": 16
}

# åŒ»ç™‚ãƒ‡ãƒ¼ã‚¿æš—å·åŒ–ã‚¯ãƒ©ã‚¹
class MedicalDataEncryption:
    """åŒ»ç™‚ãƒ‡ãƒ¼ã‚¿å°‚ç”¨æš—å·åŒ–"""
    
    @staticmethod
    def encrypt_patient_data(data: dict) -> bytes:
        """æ‚£è€…ãƒ‡ãƒ¼ã‚¿æš—å·åŒ–"""
        # PIIè¦ç´ ã®ç‰¹åˆ¥å‡¦ç†
        pii_fields = ["patient_id", "name", "ssn", "birth_date"]
        
        # ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰åˆ¥æš—å·åŒ–
        encrypted_data = {}
        for field, value in data.items():
            if field in pii_fields:
                # æœ€é«˜å¼·åº¦æš—å·åŒ–
                encrypted_data[field] = encrypt_with_patient_key(value)
            else:
                # æ¨™æº–æš—å·åŒ–
                encrypted_data[field] = encrypt_standard(value)
        
        return encrypted_data
    
    @staticmethod
    def encrypt_audit_log(log_entry: dict) -> bytes:
        """ç›£æŸ»ãƒ­ã‚°æš—å·åŒ–"""
        # æ”¹ã–ã‚“é˜²æ­¢ç½²åä»˜ãæš—å·åŒ–
        signature = create_digital_signature(log_entry)
        encrypted_log = encrypt_with_audit_key(log_entry)
        
        return {
            "encrypted_data": encrypted_log,
            "signature": signature,
            "timestamp": time.time()
        }
```

### ã‚­ãƒ¼ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ 

```python
# éšå±¤å‹ã‚­ãƒ¼ç®¡ç†
KEY_HIERARCHY = {
    "master_key": {
        "algorithm": "RSA-4096",
        "storage": "HSM",  # Hardware Security Module
        "rotation_period": "1_year"
    },
    "data_encryption_keys": {
        "patient_data_key": {
            "derived_from": "master_key",
            "algorithm": "AES-256",
            "rotation_period": "3_months"
        },
        "audit_log_key": {
            "derived_from": "master_key", 
            "algorithm": "AES-256",
            "rotation_period": "1_month"
        },
        "backup_key": {
            "derived_from": "master_key",
            "algorithm": "AES-256",
            "rotation_period": "6_months"
        }
    }
}

class KeyManagementService:
    """ã‚­ãƒ¼ç®¡ç†ã‚µãƒ¼ãƒ“ã‚¹"""
    
    def rotate_keys(self, key_type: str):
        """å®šæœŸã‚­ãƒ¼ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³"""
        if key_type == "patient_data_key":
            # æ‚£è€…ãƒ‡ãƒ¼ã‚¿ã‚­ãƒ¼ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³
            old_key = self.get_current_key(key_type)
            new_key = self.generate_new_key(key_type)
            
            # æ®µéšçš„ç§»è¡Œ
            self.mark_key_for_retirement(old_key)
            self.activate_new_key(new_key)
            
            # ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§å†æš—å·åŒ–
            self.schedule_reencryption(old_key, new_key)
    
    def emergency_key_revocation(self, key_id: str):
        """ç·Šæ€¥ã‚­ãƒ¼ç„¡åŠ¹åŒ–"""
        self.revoke_key_immediately(key_id)
        self.notify_security_team()
        self.generate_incident_report()
```

## ğŸ” ç›£æŸ»ãƒ»ãƒ­ã‚°ç®¡ç†

### HIPAAæº–æ‹ ç›£æŸ»ãƒ­ã‚°

```python
# ç›£æŸ»ãƒ­ã‚°è¦ä»¶
AUDIT_LOG_REQUIREMENTS = {
    "retention_period": "7_years",  # HIPAAè¦ä»¶
    "tamper_proof": True,
    "real_time_monitoring": True,
    "encryption": True,
    "digital_signature": True
}

class HIPAAAuditLogger:
    """HIPAAæº–æ‹ ç›£æŸ»ãƒ­ã‚°"""
    
    def log_access(self, user, resource, action, result):
        """ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°è¨˜éŒ²"""
        log_entry = {
            "timestamp": datetime.utcnow(),
            "user_id": user.id,
            "user_role": user.role,
            "user_department": user.department,
            "resource": resource,
            "action": action,
            "result": result,
            "ip_address": self.get_client_ip(),
            "user_agent": self.get_user_agent(),
            "session_id": self.get_session_id(),
            "request_id": self.get_request_id()
        }
        
        # PHI ã‚¢ã‚¯ã‚»ã‚¹ã®ç‰¹åˆ¥è¨˜éŒ²
        if self.is_phi_resource(resource):
            log_entry.update({
                "phi_access": True,
                "business_justification": self.get_justification(),
                "minimum_necessary": self.validate_minimum_necessary(),
                "authorization_verified": self.check_authorization()
            })
        
        # æš—å·åŒ–ã—ã¦ä¿å­˜
        encrypted_log = self.encrypt_log_entry(log_entry)
        self.store_audit_log(encrypted_log)
        
        # ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ç›£è¦–
        if self.is_suspicious_activity(log_entry):
            self.trigger_security_alert(log_entry)
    
    def log_data_modification(self, user, model, object_id, changes):
        """ãƒ‡ãƒ¼ã‚¿å¤‰æ›´ãƒ­ã‚°"""
        log_entry = {
            "timestamp": datetime.utcnow(),
            "event_type": "DATA_MODIFICATION",
            "user_id": user.id,
            "model": model.__name__,
            "object_id": object_id,
            "changes": {
                "before": self.sanitize_sensitive_data(changes.get("before")),
                "after": self.sanitize_sensitive_data(changes.get("after"))
            },
            "modification_reason": self.get_modification_reason()
        }
        
        self.store_audit_log(self.encrypt_log_entry(log_entry))
```

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£è¦–

```python
# ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¤ãƒ™ãƒ³ãƒˆæ¤œçŸ¥
SECURITY_RULES = {
    "failed_login_attempts": {
        "threshold": 3,
        "time_window": "5_minutes",
        "action": "lock_account"
    },
    "privilege_escalation": {
        "detection": "role_change_without_approval",
        "action": "immediate_alert"
    },
    "data_exfiltration": {
        "detection": "bulk_download_pattern",
        "threshold": "100_records_per_hour",
        "action": "block_and_alert"
    },
    "after_hours_access": {
        "time_range": "22:00-06:00",
        "allowed_roles": ["doctor", "nurse"],
        "emergency_only": True
    }
}

class SecurityMonitor:
    """ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£è¦–ã‚·ã‚¹ãƒ†ãƒ """
    
    def detect_anomalies(self):
        """ç•°å¸¸æ¤œçŸ¥"""
        # æ©Ÿæ¢°å­¦ç¿’ãƒ™ãƒ¼ã‚¹ã®ç•°å¸¸æ¤œçŸ¥
        user_behavior = self.analyze_user_patterns()
        anomalies = self.ml_anomaly_detection(user_behavior)
        
        for anomaly in anomalies:
            if anomaly.confidence > 0.8:
                self.trigger_security_incident(anomaly)
    
    def check_compliance_violations(self):
        """ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹é•åãƒã‚§ãƒƒã‚¯"""
        violations = []
        
        # HIPAAæœ€å°å¿…è¦åŸå‰‡ãƒã‚§ãƒƒã‚¯
        excessive_access = self.detect_excessive_data_access()
        if excessive_access:
            violations.append({
                "type": "minimum_necessary_violation",
                "details": excessive_access
            })
        
        # è·å‹™åˆ†é›¢åŸå‰‡ãƒã‚§ãƒƒã‚¯
        segregation_violations = self.check_segregation_of_duties()
        violations.extend(segregation_violations)
        
        return violations
```

## ğŸš¨ ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå¯¾å¿œ

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆåˆ†é¡

```python
INCIDENT_CLASSIFICATION = {
    "P1_CRITICAL": {
        "description": "æ‚£è€…ãƒ‡ãƒ¼ã‚¿æ¼æ´©ã€ã‚·ã‚¹ãƒ†ãƒ ä¾µå®³",
        "response_time": "15_minutes",
        "escalation": ["CISO", "CEO", "Legal"]
    },
    "P2_HIGH": {
        "description": "ä¸æ­£ã‚¢ã‚¯ã‚»ã‚¹ã€æ¨©é™æ˜‡æ ¼",
        "response_time": "1_hour",
        "escalation": ["CISO", "IT_Manager"]
    },
    "P3_MEDIUM": {
        "description": "ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒãƒªã‚·ãƒ¼é•å",
        "response_time": "4_hours",
        "escalation": ["Security_Team"]
    },
    "P4_LOW": {
        "description": "è»½å¾®ãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å•é¡Œ",
        "response_time": "24_hours",
        "escalation": ["System_Admin"]
    }
}

class IncidentResponse:
    """ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå¯¾å¿œã‚·ã‚¹ãƒ†ãƒ """
    
    def handle_security_incident(self, incident_type, details):
        """ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå‡¦ç†"""
        # ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆåˆ†é¡
        priority = self.classify_incident(incident_type, details)
        
        # å³åº§ã®å¯¾å¿œ
        if priority == "P1_CRITICAL":
            self.immediate_containment(details)
            self.notify_executives(details)
            self.contact_legal_team(details)
            
            # HIPAAé•åé€šçŸ¥ï¼ˆå¿…è¦ã«å¿œã˜ã¦ï¼‰
            if self.is_hipaa_breach(details):
                self.initiate_breach_notification_process(details)
        
        # ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆè¨˜éŒ²
        incident_record = self.create_incident_record(
            priority, incident_type, details
        )
        
        # èª¿æŸ»é–‹å§‹
        self.start_forensic_investigation(incident_record)
        
        return incident_record
    
    def breach_notification_process(self, incident):
        """ãƒ‡ãƒ¼ã‚¿æ¼æ´©é€šçŸ¥ãƒ—ãƒ­ã‚»ã‚¹"""
        # HIPAA 72æ™‚é–“ãƒ«ãƒ¼ãƒ«
        if self.affects_500_or_more_individuals(incident):
            # HHSï¼ˆä¿å¥ç¦ç¥‰çœï¼‰ã¸ã®é€šçŸ¥
            self.notify_hhs_within_60_days(incident)
            
            # ãƒ¡ãƒ‡ã‚£ã‚¢é€šçŸ¥
            self.notify_media_within_60_days(incident)
        
        # å€‹äººã¸ã®é€šçŸ¥
        affected_individuals = self.identify_affected_individuals(incident)
        self.notify_individuals_within_60_days(affected_individuals)
        
        # å¹´æ¬¡å ±å‘Š
        self.add_to_annual_breach_report(incident)
```

## ğŸ”§ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£é–‹ç™ºãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

### ã‚»ã‚­ãƒ¥ã‚¢é–‹ç™ºãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ« (SDLC)

```yaml
# ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£é–‹ç™ºãƒ—ãƒ­ã‚»ã‚¹
secure_development_phases:
  requirements:
    - security_requirements_analysis
    - threat_modeling
    - privacy_impact_assessment
    
  design:
    - security_architecture_review
    - data_flow_analysis
    - attack_surface_analysis
    
  implementation:
    - secure_coding_standards
    - static_application_security_testing
    - dependency_vulnerability_scanning
    
  testing:
    - dynamic_application_security_testing
    - penetration_testing
    - security_unit_testing
    
  deployment:
    - security_configuration_review
    - production_security_hardening
    - security_monitoring_setup
    
  maintenance:
    - regular_security_assessments
    - vulnerability_management
    - security_patch_management
```

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼

```python
# ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ
SECURITY_CODE_REVIEW_CHECKLIST = {
    "input_validation": [
        "ã™ã¹ã¦ã®å…¥åŠ›ã¯æ¤œè¨¼ã•ã‚Œã¦ã„ã‚‹ã‹",
        "SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³å¯¾ç­–ã¯é©åˆ‡ã‹",
        "XSSå¯¾ç­–ã¯å®Ÿè£…ã•ã‚Œã¦ã„ã‚‹ã‹",
        "ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰åˆ¶é™ã¯é©åˆ‡ã‹"
    ],
    "authentication_authorization": [
        "èªè¨¼ã¯é©åˆ‡ã«å®Ÿè£…ã•ã‚Œã¦ã„ã‚‹ã‹",
        "ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ã¯å®‰å…¨ã‹",
        "æ¨©é™ãƒã‚§ãƒƒã‚¯ã¯é©åˆ‡ã‹",
        "ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å‡¦ç†ã¯å®‰å…¨ã‹"
    ],
    "data_protection": [
        "æ©Ÿå¯†ãƒ‡ãƒ¼ã‚¿ã¯æš—å·åŒ–ã•ã‚Œã¦ã„ã‚‹ã‹",
        "ãƒ‡ãƒ¼ã‚¿æ¼æ´©å¯¾ç­–ã¯é©åˆ‡ã‹",
        "ãƒ­ã‚°ã«æ©Ÿå¯†æƒ…å ±ã¯å«ã¾ã‚Œã¦ã„ãªã„ã‹",
        "ãƒ‡ãƒ¼ã‚¿å‰Šé™¤ã¯ç¢ºå®Ÿã«è¡Œã‚ã‚Œã‚‹ã‹"
    ],
    "error_handling": [
        "ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«æ©Ÿå¯†æƒ…å ±ã¯å«ã¾ã‚Œã¦ã„ãªã„ã‹",
        "ä¾‹å¤–å‡¦ç†ã¯é©åˆ‡ã‹",
        "ãƒ­ã‚°è¨˜éŒ²ã¯é©åˆ‡ã‹",
        "ãƒ‡ãƒãƒƒã‚°æƒ…å ±ã¯æœ¬ç•ªã§ç„¡åŠ¹åŒ–ã•ã‚Œã‚‹ã‹"
    ]
}

# è‡ªå‹•ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒã‚§ãƒƒã‚¯
def automated_security_check(code_changes):
    """è‡ªå‹•ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒã‚§ãƒƒã‚¯"""
    issues = []
    
    # é™çš„è§£æ
    bandit_results = run_bandit_scan(code_changes)
    semgrep_results = run_semgrep_scan(code_changes)
    
    # ä¾å­˜é–¢ä¿‚ãƒã‚§ãƒƒã‚¯
    safety_results = run_safety_check()
    
    # ã‚«ã‚¹ã‚¿ãƒ ãƒ«ãƒ¼ãƒ«ãƒã‚§ãƒƒã‚¯
    custom_issues = check_medical_data_patterns(code_changes)
    
    return {
        "static_analysis": bandit_results + semgrep_results,
        "dependency_issues": safety_results,
        "custom_rules": custom_issues
    }
```

## ğŸ“Š ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ¡ãƒˆãƒªã‚¯ã‚¹

### KPIãƒ»ãƒ¡ãƒˆãƒªã‚¯ã‚¹

```python
SECURITY_METRICS = {
    "compliance_metrics": {
        "hipaa_compliance_score": "percentage",
        "audit_findings": "count",
        "policy_violations": "count_per_month"
    },
    "threat_metrics": {
        "security_incidents": "count_per_month",
        "blocked_attacks": "count_per_day",
        "false_positive_rate": "percentage"
    },
    "vulnerability_metrics": {
        "critical_vulnerabilities": "count",
        "mean_time_to_patch": "days",
        "vulnerability_age": "days"
    },
    "access_metrics": {
        "failed_login_attempts": "count_per_day",
        "privileged_access_usage": "count_per_month",
        "dormant_accounts": "count"
    }
}

class SecurityDashboard:
    """ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰"""
    
    def generate_monthly_report(self):
        """æœˆæ¬¡ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ¬ãƒãƒ¼ãƒˆ"""
        return {
            "executive_summary": self.get_executive_summary(),
            "threat_landscape": self.get_threat_analysis(),
            "compliance_status": self.get_compliance_status(),
            "incident_analysis": self.get_incident_analysis(),
            "risk_assessment": self.get_risk_assessment(),
            "recommendations": self.get_security_recommendations()
        }
```

## ğŸ”„ ç¶™ç¶šçš„ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ”¹å–„

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è‡ªå‹•åŒ–

```bash
#!/bin/bash
# æ—¥æ¬¡ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒã‚§ãƒƒã‚¯
daily_security_check() {
    # è„†å¼±æ€§ã‚¹ã‚­ãƒ£ãƒ³
    run_vulnerability_scan
    
    # ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­å®šç¢ºèª
    verify_security_configurations
    
    # ç•°å¸¸ãªã‚¢ã‚¯ã‚»ã‚¹ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒã‚§ãƒƒã‚¯
    analyze_access_patterns
    
    # æš—å·åŒ–çŠ¶æ…‹ç¢ºèª
    verify_encryption_status
    
    # ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—æ•´åˆæ€§ç¢ºèª
    verify_backup_integrity
}

# é€±æ¬¡ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ¬ãƒ“ãƒ¥ãƒ¼
weekly_security_review() {
    # ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ­ã‚°åˆ†æ
    analyze_security_logs
    
    # ãƒšãƒãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆ
    run_automated_pentest
    
    # ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹ãƒã‚§ãƒƒã‚¯
    run_compliance_check
    
    # ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ¡ãƒˆãƒªã‚¯ã‚¹æ›´æ–°
    update_security_metrics
}
```

---

**ã“ã®åŒ…æ‹¬çš„ãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­è¨ˆã«ã‚ˆã‚Šã€ShiftMasterã¯åŒ»ç™‚æ©Ÿé–¢ãŒè¦æ±‚ã™ã‚‹æœ€é«˜ãƒ¬ãƒ™ãƒ«ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£åŸºæº–ã‚’æº€ãŸã—ã¾ã™ã€‚**

**æœ€çµ‚æ›´æ–°**: 2024å¹´1æœˆ20æ—¥  
**ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 1.0.0
